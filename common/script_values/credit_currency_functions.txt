debt_bound = {
	value = var:bank_reserves
	divide = var:reserves_rate
	add = 1 # to avoid division by zero
}

leverage_rate = {
	value = var:total_debt
	divide = gdp
}

trade_deficit_factor = {
	value = 1 # for test
}

risk_premium_factor = {
	value = 4
	subtract = {
		desc = "credit_level_modifier"
		value = var:credit_level
	}
	pow = leverage_rate
}

real_interest_rate = {
	value = 0.04
	multiply = var:bank_interest_rate_factor
	multiply = risk_premium_factor
	multiply = trade_deficit_factor
}

leverage_target = {
	value = var:target_debt_change
	add = var:total_debt
	divide = debt_bound
}

target_risk_premium = {
	value = 4
	subtract = var:credit_level
	pow = leverage_target
}

target_interest_rate = {
	value = 0.04
	multiply = var:bank_interest_rate_factor
	multiply = target_risk_premium
	multiply = trade_deficit_factor
}

gdp_growth_rate = {
	value = var:this_season_gdp
	subtract = var:last_season_gdp
	divide = var:last_season_gdp
	multiply = 2 # to annualize from half-yearly data
	multiply = var:confidence_factor
}

target_debt = {
	value = var:total_debt
	add = var:target_debt_change
}

weekly_interest = {
	value = var:total_debt
	multiply = {
		value = real_interest_rate
		divide = 52
	}
}

# value before recursive calculation
debt_change = {
	if = {
		limit = {
			real_interest_rate > gdp_growth_rate
		}
		value = investment_pool_gross_income
		max = total_debt
		multiply = -1
	}
	else = {
		value = var:turnover_amount
	}
}